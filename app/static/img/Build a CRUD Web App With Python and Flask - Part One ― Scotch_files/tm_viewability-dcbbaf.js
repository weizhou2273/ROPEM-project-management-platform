(function(){
var g="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(c.get||c.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)},k="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;function l(){l=function(){};k.Symbol||(k.Symbol=m)}var n=0;function m(a){return"jscomp_symbol_"+(a||"")+n++}
function p(){l();var a=k.Symbol.iterator;a||(a=k.Symbol.iterator=k.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&g(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return r(this)}});p=function(){}}function r(a){var b=0;return t(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})}function t(a){p();a={next:a};a[k.Symbol.iterator]=function(){return this};return a}function u(a){p();var b=a[Symbol.iterator];return b?b.call(a):r(a)}
function v(a,b){if(b){var c=k;a=a.split(".");for(var d=0;d<a.length-1;d++){var f=a[d];f in c||(c[f]={});c=c[f]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&g(c,a,{configurable:!0,writable:!0,value:b})}}
v("Promise",function(a){function b(a){this.b=0;this.h=void 0;this.a=[];var b=this.c();try{a(b.resolve,b.reject)}catch(h){b.reject(h)}}function c(){this.a=null}if(a)return a;c.prototype.b=function(a){this.a||(this.a=[],this.c());this.a.push(a)};c.prototype.c=function(){var a=this;this.f(function(){a.h()})};var d=k.setTimeout;c.prototype.f=function(a){d(a,0)};c.prototype.h=function(){for(;this.a&&this.a.length;){var a=this.a;this.a=[];for(var b=0;b<a.length;++b){var c=a[b];delete a[b];try{c()}catch(y){this.g(y)}}}this.a=
null};c.prototype.g=function(a){this.f(function(){throw a;})};b.prototype.c=function(){function a(a){return function(e){c||(c=!0,a.call(b,e))}}var b=this,c=!1;return{resolve:a(this.s),reject:a(this.g)}};b.prototype.s=function(a){if(a===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof b)this.v(a);else{var c;a:switch(typeof a){case "object":c=null!=a;break a;case "function":c=!0;break a;default:c=!1}c?this.o(a):this.i(a)}};b.prototype.o=function(a){var b=void 0;
try{b=a.then}catch(h){this.g(h);return}"function"==typeof b?this.B(b,a):this.i(a)};b.prototype.g=function(a){this.j(2,a)};b.prototype.i=function(a){this.j(1,a)};b.prototype.j=function(a,b){if(0!=this.b)throw Error("Cannot settle("+a+", "+b|"): Promise already settled in state"+this.b);this.b=a;this.h=b;this.l()};b.prototype.l=function(){if(this.a){for(var a=this.a,b=0;b<a.length;++b)a[b].call(),a[b]=null;this.a=null}};var f=new c;b.prototype.v=function(a){var b=this.c();a.f(b.resolve,b.reject)};b.prototype.B=
function(a,b){var c=this.c();try{a.call(b,c.resolve,c.reject)}catch(y){c.reject(y)}};b.prototype.then=function(a,c){function d(a,b){return"function"==typeof a?function(b){try{e(a(b))}catch(S){f(S)}}:b}var e,f,q=new b(function(a,b){e=a;f=b});this.f(d(a,e),d(c,f));return q};b.prototype.catch=function(a){return this.then(void 0,a)};b.prototype.f=function(a,b){function c(){switch(d.b){case 1:a(d.h);break;case 2:b(d.h);break;default:throw Error("Unexpected state: "+d.b);}}var d=this;this.a?this.a.push(function(){f.b(c)}):
f.b(c)};b.resolve=function(a){return a instanceof b?a:new b(function(b){b(a)})};b.reject=function(a){return new b(function(b,c){c(a)})};b.b=function(a){return new b(function(c,d){for(var e=u(a),f=e.next();!f.done;f=e.next())b.resolve(f.value).f(c,d)})};b.a=function(a){var c=u(a),d=c.next();return d.done?b.resolve([]):new b(function(a,e){function f(b){return function(c){h[b]=c;q--;q||a(h)}}var h=[],q=0;do h.push(void 0),q++,b.resolve(d.value).f(f(h.length-1),e),d=c.next();while(!d.done)})};b.$jscomp$new$AsyncExecutor=
function(){return new c};return b});v("Object.is",function(a){return a?a:function(a,c){return a===c?0!==a||1/a===1/c:a!==a&&c!==c}});v("String.prototype.includes",function(a){return a?a:function(a,c){if(null==this)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(a instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return-1!==(this+"").indexOf(a,c||0)}});
var w=window.BEACON_SIZE?window.BEACON_SIZE:9,x=window.BEACON_ZINDEX?window.BEACON_ZINDEX:-9999,z=window.BEACON_OPACITY?window.BEACON_OPACITY:.01;l();var A=Symbol("Beacons");l();var B=Symbol("Beacons");function C(a){if(a!==B)throw"Beacons is a singleton: Cannot construct directly. Use 'Observer.instance'";this.Z=((new Date).getTime()+""+Math.floor(1E7*Math.random())).substr(0,16)}
C.prototype.aa=function(a,b){var c=this;this.f=a;this.A=b;this.g=[];this.a=Array(14);this.ca=0;this.i=1;this.o=2;this.s=3;this.j=4;this.l=5;this.K=6;this.S=7;this.I=8;this.J=9;this.M=10;this.O=11;this.v=12;this.B=13;D(this,!0);return new Promise(function(a,b){for(var d=[],f=0;f<c.h.length;f++){var h=new E(c.f,f,c.Z,c.h[f],c.da.bind(c));c.g.push(h);d.push(F(h))}Promise.all(d).then(c.U.bind(c)).then(a).catch(b)})};
function D(a,b){b=void 0===b?!1:b;a.T=a.f.getBoundingClientRect();a.b=a.T.width;a.c=a.T.height;var c=Math.sqrt(2),d=a.b/(1+c),f=a.c/(1+c),e=a.b/c,c=a.c/c;a.h=[{name:"CONTROL",left:b?a.b/2:-1E4,top:b?a.b/2:-1E4},{name:"CENTER",left:(a.b-w)/2,top:(a.c-w)/2},{name:"OUTER_TOP_LEFT",left:1,top:1},{name:"OUTER_TOP_RIGHT",left:a.b-w-1,top:1},{name:"OUTER_BOTTOM_LEFT",left:1,top:a.c-w-1},{name:"OUTER_BOTTOM_RIGHT",left:a.b-w-1,top:a.c-w-1},{name:"MIDDLE_TOP_LEFT",left:(a.b-e-w)/2,top:(a.c-c-w)/2},{name:"MIDDLE_TOP_RIGHT",
left:(a.b+e-w)/2,top:(a.c-c-w)/2},{name:"MIDDLE_BOTTOM_LEFT",left:(a.b-e-w)/2,top:(a.c+c-w)/2},{name:"MIDDLE_BOTTOM_RIGHT",left:(a.b+e-w)/2,top:(a.c+c-w)/2},{name:"INNER_TOP_LEFT",left:(a.b-d-w)/2,top:(a.c-f-w)/2},{name:"INNER_TOP_RIGHT",left:(a.b+d-w)/2,top:(a.c-f-w)/2},{name:"INNER_BOTTOM_LEFT",left:(a.b-d-w)/2,top:(a.c+f-w)/2},{name:"INNER_BOTTOM_RIGHT",left:(a.b+d-w)/2,top:(a.c+f-w)/2}]}
C.prototype.U=function(){D(this);for(var a=0;a<this.h.length;a++){var b=this.g[a].u,c=this.h[a];b.style.top=c.top+"px";b.style.left=c.left+"px"}};C.prototype.da=function(a){switch(a.type){case "ready":this.g[a.index].resolve();this.a[a.index]=a.state;break;case "inview":this.a[a.index]=!0;break;case "outofview":this.a[a.index]=!1}};
C.prototype.$=function(){var a=0,b=0,c=0,d=0;if(this.a[this.ca])return"unmeasurable";for(var f=this.g.length-1,e=1;e<this.a.length;e++)if(this.a[e])switch(a++,e){case this.o:case this.s:case this.j:case this.l:b++;break;case this.K:case this.S:case this.I:case this.J:c++;break;case this.M:case this.O:case this.v:case this.B:d++}if(a===f)c="viewable";else if(100==this.A)c="unviewable";else{a:{d=[[this.o,this.K,this.M,this.i,this.B,this.J,this.l],[this.s,this.S,this.O,this.i,this.v,this.I,this.j]];
for(f=0;2>f;f++)for(var e=d[f],q=b=0;q<e.length;q++)if(a=this.a[e[q]],!0===a&&!b)b++;else if(!1===a&&1==b)b++;else if(!0===a&&2==b){a=!0;break a}a=!1}c=a?"unmeasurable":!0===this.a[this.i]&&(!0===this.a[this.o]&&!0===this.a[this.s]||!0===this.a[this.o]&&!0===this.a[this.j]||!0===this.a[this.s]&&!0===this.a[this.l]||!0===this.a[this.j]&&!0===this.a[this.l])||!0===this.a[this.i]&&4==c?"viewable":"unviewable"}return c};C.prototype.ba=function(){this.g.forEach(function(a){clearInterval(a.fa);a.u.parentNode.removeChild(a.u)})};
k.Object.defineProperties(C,{a:{configurable:!0,enumerable:!0,get:function(){this[A]||(this[A]=new C(B));return this[A]}}});function E(a,b,c,d,f){this.h=a;this.index=b;this.g="frame_"+b+c;this.a="beaconProcess_"+b+c;this.c=d;this.resolve=null;this.b="number"===typeof window.mozPaintCount;this.f=f;this.u=document.createElement("iframe")}
function F(a){var b="",b=a.b?"parent.window."+a.a+"()":"window.frameCount = 0;var render = function(timestamp){   window.frameCount++;    requestAnimationFrame(render.bind(this));};render();parent.window."+a.a+"()";a.i="<html><head></head><body onload='"+b+"'></body></html>";G(a);return new Promise(function(b){a.resolve=b;a.h.appendChild(a.u);a.u.id=a.g;a.u.style.cssText="position:absolute;border:none;z-index:"+x+";opacity:"+z+";width:"+w+"px;height:"+w+"px;top:"+a.c.top+"px;left:"+a.c.left+"px;";
a.u.contentWindow.document.open().write(a.i);a.u.contentWindow.document.close()})}
function G(a){window[a.a]=function(){var b=a.u.contentWindow,c=a.b?0:4,d=a.b?"mozPaintCount":"frameCount",f=!1,e=!1,q=b[d];a.fa=setInterval(function(){var h=b[d];!e&&h-q>c?(e=!0,a.f({type:"inview",index:a.index},"*")):e&&h-q<=c&&(e=!1,a.f({type:"outofview",index:a.index}));q=h;h=(16+Math.round(52*Math.random())).toString(16);b.document.body.style.background=!0===e?"#"+h+"ff"+h:"#ff"+h+h;!1===f&&(a.f({type:"ready",index:a.index,state:e}),f=!0)},200)}};l();var H=Symbol("Geometry");l();var I=Symbol("Geometry");
function J(a){var b=this;if(a!==I)throw"Geometry is a singleton: Cannot construct directly. Use 'Geometry.instance'";this.i=function(){for(var a=b.a(window),d=a.w,f=window,e;f!=window.top;)f=f.parent,e=b.a(f),e.w<d&&(d=e.w,a=e);return a};this.a=function(a){var b={width:Infinity,height:Infinity,w:Infinity};!isNaN(a.document.body.clientWidth)&&0<a.document.body.clientWidth&&(b.width=a.document.body.clientWidth);!isNaN(a.document.body.clientHeight)&&0<a.document.body.clientHeight&&(b.height=a.document.body.clientHeight);
a.document.documentElement&&a.document.documentElement.clientWidth&&!isNaN(a.document.documentElement.clientWidth)&&(b.width=a.document.documentElement.clientWidth);a.document.documentElement&&a.document.documentElement.clientHeight&&!isNaN(a.document.documentElement.clientHeight)&&(b.height=a.document.documentElement.clientHeight);a.innerWidth&&!isNaN(a.innerWidth)&&(b.width=Math.min(b.width,a.innerWidth));a.innerHeight&&!isNaN(a.innerHeight)&&(b.height=Math.min(b.height,a.innerHeight));b.w=b.height*
b.width;return b};this.b=function(a,d){var c=d.parent,e={width:0,height:0,left:0,right:0,top:0,bottom:0};a&&(e=b.c(a,d),e.width=e.right-e.left,e.height=e.bottom-e.top,d!=c&&(d=b.b(d.frameElement,c),d.bottom<e.bottom&&(d.bottom<e.top&&(e.top=d.bottom),e.bottom=d.bottom),d.right<e.right&&(d.right<e.left&&(e.left=d.right),e.right=d.right),e.width=e.right-e.left,e.height=e.bottom-e.top));return e};this.c=function(a,d){var c=d.parent,e={left:0,right:0,top:0,bottom:0};a&&(a=a.getBoundingClientRect(),d!=
c?e=b.c(d.frameElement,c):e={left:a.left+e.left,right:a.right+e.left,top:a.top+e.top,bottom:a.bottom+e.top});return e}}J.prototype.h=function(a){this.f=a};function K(){try{if(window.top==window)return!0;for(var a=window;a.parent!=a;){if(a.parent.document.domain!=a.document.domain)return!1;a=a.parent}return!0}catch(b){}return!1}
J.prototype.g=function(a){var b=this.i();if(Infinity==b.w)return{error:"unmeasurable"};var c=this.f.getBoundingClientRect(),c=c.width*c.height;if(b.w/c<a)a=Math.floor(100*b.w/c);else{var d=this.a(window.top);a=this.b(this.f,window);a.bottom>d.height&&(a.height-=a.bottom-d.height);0>a.top&&(a.height+=a.top);0>a.left&&(a.width+=a.left);a.right>d.width&&(a.width-=a.right-d.width);a=Math.floor(100*a.width*a.height/c)}return{clientWidth:d.width,clientHeight:d.height,V:a}};
k.Object.defineProperties(J,{a:{configurable:!0,enumerable:!0,get:function(){this[H]||(this[H]=new J(I));return this[H]}}});l();var L=Symbol("Observer");l();var M=Symbol("Observer");function N(a){if(a!==M)throw"Observer is a singleton: Cannot construct directly. Use 'Observer.instance'";this.a=0}N.prototype.f=function(a){this.target=a;this.b=new window.IntersectionObserver(this.h.bind(this),{threshold:[0,.1,.2,.3,.4,.5,.6,.7,.8,.9,1]});this.b.observe(this.target)};N.prototype.c=function(){this.b.unobserve(this.target)};N.prototype.h=function(a){var b=this;0==a.length?this.a=0:a.forEach(function(a){b.a=a.intersectionRatio})};
N.prototype.g=function(){return this.a};k.Object.defineProperties(N,{a:{configurable:!0,enumerable:!0,get:function(){this[L]||(this[L]=new N(M));return this[L]}}});l();var O=Symbol("ViewabilityModel");l();var P=Symbol("ViewabilityModel");function Q(a){if(a!==P)throw"ViewabilityModel is a singleton: Cannot construct directly. Use 'ViewabilityModel.instance'";this.ea=5;this.ja=1;this.A=this.Y=-1;this.a=Q.a.MRC}
k.Object.defineProperties(Q.prototype,{m:{configurable:!0,enumerable:!0,set:function(a){a&&a in Q.a&&(this.a=Q.a[a])},get:function(){return this.a}},L:{configurable:!0,enumerable:!0,get:function(){return this.m.L}},R:{configurable:!0,enumerable:!0,get:function(){return this.m.R}},H:{configurable:!0,enumerable:!0,get:function(){return this.m.H}},N:{configurable:!0,enumerable:!0,get:function(){return this.m.N}},F:{configurable:!0,enumerable:!0,get:function(){return this.m.F}},P:{configurable:!0,enumerable:!0,
get:function(){return this.m.P}}});k.Object.defineProperties(Q,{b:{configurable:!0,enumerable:!0,get:function(){this[O]||(this[O]=new Q(P));return this[O]}},a:{configurable:!0,enumerable:!0,get:function(){return{GROUPM:{L:100,R:!0,H:200,N:!1,F:null,P:50},MRC:{L:50,R:!1,H:200,N:!0,F:2,P:null}}}},c:{configurable:!0,enumerable:!0,get:function(){return"MRC"}},f:{configurable:!0,enumerable:!0,get:function(){return"GROUPM"}}});l();var R=Symbol("ViewabilityControl");l();var T=Symbol("ViewabilityControl");
function U(a){if(a!==T)throw"ViewabilityControl is a singleton: Cannot construct directly. Use 'ViewabilityControl.instance'";this.a="NONE";this.l=NaN;this.O=this.v=0;this.i=this.g=this.s=!1;this.c=0;this.h="err";this.f=this.j=null;window.addEventListener("resize",this.B.bind(this),!1)}
function V(a,b,c){var d=U.a;d.f=b;d.b=a;d.K=c;new Promise(function(a){if("function"===typeof window.IntersectionObserver)N.a.f.call(N.a,d.f),d.a=W.b,a(!0);else{var b=X.a;b.ga&&"number"===typeof window.mozPaintCount||b.ha&&"function"===typeof window.requestAnimationFrame?(d.a=W.a,C.a.aa.call(C.a,d.f,d.b.A).then(a.bind(null,!0)).catch(a.bind(null,!1))):K()?(J.a.h.call(J.a,d.f),d.a=W.c,a(!0)):(d.o.call(d,"ifr"),a(!1))}})}U.prototype.B=function(){switch(this.a){case W.a:C.a.U.call(C.a)}};
function aa(a){document.fullscreenElement==a.f&&(a.j={W:a.a,X:a.c},a.a=W.f);["webkitbeginfullscreen","webkitendfullscreen","webkitfullscreenchange","mozfullscreenchange","fullscreenchange"].forEach(function(b){a.f.addEventListener(b,function(){document.fullscreenElement==a.f?(a.j={W:a.a,X:a.c},a.a=W.f):(a.a=a.j.W,a.c=a.j.X,a.j=null)})})}
function ba(a){var b;if(!(b=document.hidden)){var c=window.getComputedStyle(a.f);b=c.getPropertyValue("visibility");c=c.getPropertyValue("display");b=!("hidden"!==b&&"none"!==c)}if(b)return a.h="f";switch(a.a){case W.f:return a.g=!0,a.i=!1,a.c=100,a.h="t";case W.b:return a.c=Math.round(100*N.a.g.call(N.a)),a.g=a.c>=a.b.A,a.i=!1,a.h=a.g?"t":"f";case W.a:return b=C.a.$.call(C.a),a.g="viewable"===b,a.i="unmeasurable"===b,a.c=0,a.h=a.g?"t":a.i?"err":"f";case W.c:return b=J.a.g.call(J.a,a.b.A/100),a.g=
b.V>=a.b.A,a.i="unmeasurable"===b.error,a.c=b.V,a.h=a.g?"t":a.i?"ifr":"f"}return"err"}U.prototype.M=function(){var a=ba(this);"t"==a?++this.v>=this.b.Y&&Y(this):"f"==a?this.b.m.N&&(this.v=0):++this.O>this.b.ea&&Y(this)};function Y(a){a.s||(a.s=!0,a.o.call(a,a.h))}
U.prototype.o=function(a){if("t:err:ifr".includes(a)){var b;try{var c=X.a;b=[X.v,c.code+":"+c.version,"IF:"+X.b].join(":::")}catch(d){b="error in ViewabilityEnv::getEnvStr()"}b={vwbl:this.h,vver:this.b.ja,vpct:this.c,venv:b,ifr:X.b!==X.f};b.vwbl=a;this.K(b)}else void 0};U.prototype.I=function(){this.a===W.b&&N.a.f.call(N.a,this.f);aa(this);Z(this);this.l=setInterval(this.M.bind(this),this.b.m.H)};
U.prototype.J=function(){window.removeEventListener("resize",this.B);Z(this);switch(this.a){case W.b:N.a.b&&N.a.c.call(N.a);break;case W.a:C.a.ba.call(C.a)}};function Z(a){isNaN(a.l)||(clearInterval(a.l),a.l=NaN)}k.Object.defineProperties(U,{a:{configurable:!0,enumerable:!0,get:function(){this[R]||(this[R]=new U(T));return this[R]}}});function W(){}
k.Object.defineProperties(W,{b:{configurable:!0,enumerable:!0,get:function(){return"INTERSECTION_OBSERVER"}},a:{configurable:!0,enumerable:!0,get:function(){return"IFRAME_BEACONS"}},c:{configurable:!0,enumerable:!0,get:function(){return"BROWSER_GEOMETRY"}},f:{configurable:!0,enumerable:!0,get:function(){return"FULL_SCREEN_OVERRIDE"}}});function X(){}
k.Object.defineProperties(X,{c:{configurable:!0,enumerable:!0,get:function(){return"CH"}},h:{configurable:!0,enumerable:!0,get:function(){return"FF"}},l:{configurable:!0,enumerable:!0,get:function(){return"SF"}},i:{configurable:!0,enumerable:!0,get:function(){return"IE"}},j:{configurable:!0,enumerable:!0,get:function(){return"OP"}},g:{configurable:!0,enumerable:!0,get:function(){return"ME"}},f:{configurable:!0,enumerable:!0,get:function(){return"F0"}},o:{configurable:!0,enumerable:!0,get:function(){return"FS"}},
s:{configurable:!0,enumerable:!0,get:function(){return"FX"}},b:{configurable:!0,enumerable:!0,get:function(){try{if(window.top==window)return X.f;if(window.top.document.domain==window.document.domain)return X.o}catch(a){}return X.s}},a:{configurable:!0,enumerable:!0,get:function(){var a;a:{for(var b=[{C:"Edge",D:"Edge.([0-9]+)",name:"MicroSoftEdge",code:"ME"},{C:"Chrome",D:"Chrome.([0-9]+)",name:"chrome",code:"CH"},{ia:navigator.vendor,C:"Apple",D:"(?:Version|Safari).([1-9]?\\d)[^0-9]",name:"safari",
code:"SF"},{C:"Opera",D:"Version.([0-9]+)",name:"opera",code:"OP"},{C:"Firefox",D:"Firefox.([0-9]+)",name:"firefox",code:"FF"},{C:"MSIE|Trident.7",D:"(?:MSIE| rv).([0-9]+)",name:"internet explorer",code:"IE"}],c=0;c<b.length;c++)if((new RegExp(b[c].C)).test(b[c].ia||navigator.userAgent)){a=new RegExp(".*"+b[c].D+".*");b={name:b[c].name,code:b[c].code};b.version=navigator.userAgent.replace(a,"$1");a=b;break a}a=void 0}a=a||{name:"Unknown",code:"??",version:0};a.ka=a.code===X.c;a.ha=a.code===X.l;a.ga=
a.code===X.h;a.ma=a.code===X.i;a.na=a.code===X.j;a.la=a.code===X.g;return a}},v:{configurable:!0,enumerable:!0,get:function(){[{test:"Mac",G:"Mac"},{test:"Win",G:"Win"},{test:"i(Phone|Pad)",G:"iOS"},{test:"Linux arm",G:"Android"},{test:"Linux",G:"Linux"}].forEach(function(a){if((new RegExp(a.test)).test(navigator.platform))return a.G});return"Other"}}});
window.TMViewability=function(a){var b=a.targetElement,c=a.vimpCallback;a=a.viewabilityStandard;var d=Q.b;d.m=void 0===a?"MRC":a;d.A=d.m.L;null!==d.m.F&&(d.Y=Math.ceil(1E3*d.m.F/d.m.H));V(d,b,c);return{start:U.a.I.bind(U.a),stop:U.a.J.bind(U.a)}};
}).call(this)

//# sourceMappingURL=tm_viewability.js.map
